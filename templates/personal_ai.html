<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal AI - Hybrid Edge-Cloud Router</title>
    <link href="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .chat-container {
            height: 70vh;
            overflow-y: auto;
            border: 1px solid var(--bs-secondary);
            border-radius: 8px;
            padding: 15px;
            background: var(--bs-dark);
        }
        
        .message {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 12px;
            max-width: 85%;
        }
        
        .message.user {
            background: var(--bs-primary);
            color: white;
            margin-left: auto;
            text-align: right;
        }
        
        .message.assistant {
            background: var(--bs-secondary);
            margin-right: auto;
        }
        
        .message.system {
            background: var(--bs-info);
            color: white;
            margin: 0 auto;
            text-align: center;
            font-style: italic;
        }
        
        .routing-badge {
            font-size: 0.75em;
            margin-bottom: 5px;
            display: inline-block;
        }
        
        .routing-local { background: var(--bs-success); }
        .routing-cloud { background: var(--bs-warning); }
        .routing-hybrid { background: var(--bs-info); }
        .routing-cached { background: var(--bs-secondary); }
        
        .message-meta {
            font-size: 0.8em;
            color: var(--bs-text-muted);
            margin-top: 8px;
        }
        
        .input-group {
            margin-top: 15px;
        }
        
        .stats-panel {
            background: var(--bs-dark);
            border: 1px solid var(--bs-secondary);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .stat-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .memory-panel {
            background: var(--bs-dark);
            border: 1px solid var(--bs-secondary);
            border-radius: 8px;
            padding: 15px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .memory-item {
            background: var(--bs-secondary);
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 10px;
        }
        
        .preference-item {
            background: var(--bs-info);
            color: white;
            padding: 8px;
            border-radius: 4px;
            margin-bottom: 8px;
            font-size: 0.9em;
        }
        
        .complexity-indicator {
            width: 100%;
            height: 6px;
            background: var(--bs-secondary);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .complexity-fill {
            height: 100%;
            transition: width 0.3s ease;
        }
        
        .complexity-trivial { background: var(--bs-success); }
        .complexity-simple { background: var(--bs-info); }
        .complexity-moderate { background: var(--bs-warning); }
        .complexity-complex { background: var(--bs-danger); }
        .complexity-expert { background: var(--bs-purple); }
        
        .privacy-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .privacy-meter {
            flex: 1;
            height: 4px;
            background: var(--bs-secondary);
            border-radius: 2px;
            overflow: hidden;
        }
        
        .privacy-fill {
            height: 100%;
            background: var(--bs-success);
            transition: width 0.3s ease;
        }
        
        .ollama-status {
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 500;
        }
        
        .ollama-connected {
            background: var(--bs-success);
            color: white;
        }
        
        .ollama-disconnected {
            background: var(--bs-danger);
            color: white;
        }
        
        .model-selector {
            margin-bottom: 15px;
        }
        
        .typing-indicator {
            display: none;
            padding: 10px;
            text-align: center;
            color: var(--bs-text-muted);
        }
        
        .spinner-border-sm {
            width: 1rem;
            height: 1rem;
        }
        
        .context-actions {
            margin-top: 10px;
        }
        
        .context-actions button {
            margin-right: 5px;
            margin-bottom: 5px;
        }
        
        .feedback-actions {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid var(--bs-secondary);
        }
        
        .feedback-actions button {
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <div class="container-fluid mt-3">
        <div class="row">
            <div class="col-12">
                <h1 class="text-center mb-4">
                    <i class="fas fa-brain me-2"></i>
                    Personal AI Assistant
                    <small class="text-muted d-block fs-6">Hybrid Edge-Cloud Intelligence</small>
                </h1>
            </div>
        </div>
        
        <div class="row">
            <!-- Left Panel: Chat Interface -->
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <div>
                            <h5 class="mb-0">
                                <i class="fas fa-comments me-2"></i>
                                Chat Interface
                            </h5>
                        </div>
                        <div class="d-flex align-items-center gap-3">
                            <div id="ollama-status" class="ollama-status ollama-disconnected">
                                <i class="fas fa-circle me-1"></i>
                                Ollama Disconnected
                            </div>
                            <button class="btn btn-sm btn-outline-secondary" onclick="clearChat()">
                                <i class="fas fa-trash me-1"></i>
                                Clear
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <!-- Chat Messages -->
                        <div id="chat-container" class="chat-container">
                            <div class="message system">
                                <i class="fas fa-robot me-2"></i>
                                Personal AI Assistant ready. I can help you with questions, tasks, and remember your preferences.
                            </div>
                        </div>
                        
                        <!-- Typing Indicator -->
                        <div id="typing-indicator" class="typing-indicator">
                            <div class="spinner-border spinner-border-sm text-primary me-2" role="status">
                                <span class="visually-hidden">Processing...</span>
                            </div>
                            Processing your request...
                        </div>
                        
                        <!-- Input Area -->
                        <div class="input-group mt-3">
                            <input type="text" id="message-input" class="form-control" 
                                   placeholder="Ask me anything..." 
                                   onkeypress="handleKeyPress(event)">
                            <button class="btn btn-primary" onclick="sendMessage()">
                                <i class="fas fa-paper-plane me-1"></i>
                                Send
                            </button>
                        </div>
                        
                        <!-- Context Actions -->
                        <div class="context-actions">
                            <button class="btn btn-sm btn-outline-info" onclick="addMemory()">
                                <i class="fas fa-brain me-1"></i>
                                Add Memory
                            </button>
                            <button class="btn btn-sm btn-outline-warning" onclick="setPreference()">
                                <i class="fas fa-cog me-1"></i>
                                Set Preference
                            </button>
                            <button class="btn btn-sm btn-outline-success" onclick="viewPersonalContext()">
                                <i class="fas fa-user me-1"></i>
                                Personal Context
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Right Panel: Status and Controls -->
            <div class="col-md-4">
                <!-- System Status -->
                <div class="card mb-3">
                    <div class="card-header">
                        <h6 class="mb-0">
                            <i class="fas fa-tachometer-alt me-2"></i>
                            System Status
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="stats-panel">
                            <div class="stat-item">
                                <span>Local Models:</span>
                                <span id="local-models-count">0</span>
                            </div>
                            <div class="stat-item">
                                <span>Cache Hit Rate:</span>
                                <span id="cache-hit-rate">0%</span>
                            </div>
                            <div class="stat-item">
                                <span>Stored Memories:</span>
                                <span id="memories-count">0</span>
                            </div>
                            <div class="stat-item">
                                <span>Active Preferences:</span>
                                <span id="preferences-count">0</span>
                            </div>
                        </div>
                        
                        <!-- Query Analysis -->
                        <div class="mb-3">
                            <label class="form-label">Query Complexity:</label>
                            <div class="complexity-indicator">
                                <div id="complexity-fill" class="complexity-fill complexity-simple" style="width: 20%"></div>
                            </div>
                        </div>
                        
                        <div class="privacy-indicator">
                            <span>Privacy Score:</span>
                            <div class="privacy-meter">
                                <div id="privacy-fill" class="privacy-fill" style="width: 50%"></div>
                            </div>
                            <span id="privacy-score">0.5</span>
                        </div>
                    </div>
                </div>
                
                <!-- Routing Strategy -->
                <div class="card mb-3">
                    <div class="card-header">
                        <h6 class="mb-0">
                            <i class="fas fa-route me-2"></i>
                            Routing Strategy
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="model-selector">
                            <label class="form-label">Preferred Strategy:</label>
                            <select id="routing-strategy" class="form-select">
                                <option value="auto">Auto (Hybrid)</option>
                                <option value="local">Local Only</option>
                                <option value="cloud">Cloud Only</option>
                                <option value="privacy">Privacy First</option>
                            </select>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Local Model:</label>
                            <select id="local-model" class="form-select">
                                <option value="llama3.2:3b">Llama 3.2 3B (Fast)</option>
                                <option value="llama3.1:8b">Llama 3.1 8B (Balanced)</option>
                                <option value="llama3.1:70b">Llama 3.1 70B (Quality)</option>
                            </select>
                        </div>
                        
                        <div class="d-flex gap-2">
                            <button class="btn btn-sm btn-outline-primary" onclick="testOllama()">
                                <i class="fas fa-vial me-1"></i>
                                Test Ollama
                            </button>
                            <button class="btn btn-sm btn-outline-secondary" onclick="refreshStats()">
                                <i class="fas fa-sync me-1"></i>
                                Refresh
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Personal Memory -->
                <div class="card">
                    <div class="card-header">
                        <h6 class="mb-0">
                            <i class="fas fa-memory me-2"></i>
                            Personal Memory
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="memory-panel" id="memory-panel">
                            <div class="text-center text-muted">
                                <i class="fas fa-brain fa-2x mb-2"></i>
                                <p>No memories stored yet</p>
                            </div>
                        </div>
                        
                        <div class="mt-3">
                            <h6>Active Preferences:</h6>
                            <div id="preferences-panel">
                                <div class="text-center text-muted">
                                    <i class="fas fa-cog fa-2x mb-2"></i>
                                    <p>No preferences set</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Memory Modal -->
    <div class="modal fade" id="memoryModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-brain me-2"></i>
                        Add Memory
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">Category:</label>
                        <input type="text" id="memory-category" class="form-control" placeholder="e.g., personal, work, preferences">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Key:</label>
                        <input type="text" id="memory-key" class="form-control" placeholder="e.g., birthday, favorite color">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Value:</label>
                        <textarea id="memory-value" class="form-control" rows="3" placeholder="Enter the memory content"></textarea>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Context (optional):</label>
                        <textarea id="memory-context" class="form-control" rows="2" placeholder="Additional context"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveMemory()">Save Memory</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Preference Modal -->
    <div class="modal fade" id="preferenceModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-cog me-2"></i>
                        Set Preference
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">Category:</label>
                        <select id="preference-category" class="form-select">
                            <option value="communication">Communication Style</option>
                            <option value="response">Response Format</option>
                            <option value="content">Content Preferences</option>
                            <option value="privacy">Privacy Settings</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Preference:</label>
                        <input type="text" id="preference-key" class="form-control" placeholder="e.g., tone, length, detail level">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Value:</label>
                        <input type="text" id="preference-value" class="form-control" placeholder="e.g., casual, detailed, brief">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Strength:</label>
                        <input type="range" id="preference-strength" class="form-range" min="0" max="1" step="0.1" value="0.8">
                        <small class="text-muted">How important is this preference?</small>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="savePreference()">Save Preference</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let chatHistory = [];
        let isProcessing = false;
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            checkOllamaStatus();
            refreshStats();
            loadPersonalMemory();
            
            // Auto-refresh stats every 30 seconds
            setInterval(refreshStats, 30000);
        });
        
        async function checkOllamaStatus() {
            try {
                const response = await fetch('/api/personal-ai/status');
                const data = await response.json();
                
                const statusElement = document.getElementById('ollama-status');
                if (data.ollama_connected) {
                    statusElement.className = 'ollama-status ollama-connected';
                    statusElement.innerHTML = '<i class="fas fa-circle me-1"></i>Ollama Connected';
                } else {
                    statusElement.className = 'ollama-status ollama-disconnected';
                    statusElement.innerHTML = '<i class="fas fa-circle me-1"></i>Ollama Disconnected';
                }
                
                // Update local models count
                document.getElementById('local-models-count').textContent = data.local_models || 0;
                
            } catch (error) {
                console.error('Error checking Ollama status:', error);
                const statusElement = document.getElementById('ollama-status');
                statusElement.className = 'ollama-status ollama-disconnected';
                statusElement.innerHTML = '<i class="fas fa-circle me-1"></i>Ollama Error';
            }
        }
        
        async function refreshStats() {
            try {
                const response = await fetch('/api/personal-ai/stats');
                const data = await response.json();
                
                document.getElementById('cache-hit-rate').textContent = 
                    Math.round(data.cache_hit_rate * 100) + '%';
                document.getElementById('memories-count').textContent = data.total_memories || 0;
                document.getElementById('preferences-count').textContent = data.total_preferences || 0;
                
            } catch (error) {
                console.error('Error refreshing stats:', error);
            }
        }
        
        async function loadPersonalMemory() {
            try {
                const response = await fetch('/api/personal-ai/memory');
                const data = await response.json();
                
                // Update memories
                const memoryPanel = document.getElementById('memory-panel');
                if (data.memories && data.memories.length > 0) {
                    memoryPanel.innerHTML = data.memories.map(memory => `
                        <div class="memory-item">
                            <strong>${memory.key}</strong>
                            <p class="mb-1">${memory.value}</p>
                            <small class="text-muted">${memory.category} • ${memory.created_at}</small>
                        </div>
                    `).join('');
                }
                
                // Update preferences
                const preferencesPanel = document.getElementById('preferences-panel');
                if (data.preferences && data.preferences.length > 0) {
                    preferencesPanel.innerHTML = data.preferences.map(pref => `
                        <div class="preference-item">
                            <strong>${pref.preference}:</strong> ${pref.value}
                            <small class="d-block">Strength: ${Math.round(pref.strength * 100)}%</small>
                        </div>
                    `).join('');
                }
                
            } catch (error) {
                console.error('Error loading personal memory:', error);
            }
        }
        
        function handleKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }
        
        async function sendMessage() {
            const input = document.getElementById('message-input');
            const message = input.value.trim();
            
            if (!message || isProcessing) return;
            
            isProcessing = true;
            input.value = '';
            
            // Add user message to chat
            addMessage('user', message);
            
            // Show typing indicator
            showTypingIndicator();
            
            // Analyze query for UI feedback
            analyzeQuery(message);
            
            try {
                const response = await fetch('/api/personal-ai/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message: message,
                        routing_strategy: document.getElementById('routing-strategy').value,
                        local_model: document.getElementById('local-model').value
                    })
                });
                
                const data = await response.json();
                
                if (data.error) {
                    addMessage('system', `Error: ${data.error}`);
                } else {
                    // Add assistant response
                    addMessage('assistant', data.response, data.routing_result);
                    
                    // Update chat history
                    chatHistory.push({ user: message, assistant: data.response });
                }
                
            } catch (error) {
                addMessage('system', `Network error: ${error.message}`);
            } finally {
                hideTypingIndicator();
                isProcessing = false;
            }
        }
        
        function addMessage(type, content, routingResult = null) {
            const chatContainer = document.getElementById('chat-container');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            
            let routingBadge = '';
            let messageMeta = '';
            
            if (routingResult) {
                const decision = routingResult.decision;
                const badgeClass = `routing-${decision.replace('_', '-')}`;
                routingBadge = `<span class="badge ${badgeClass} routing-badge">${decision.toUpperCase()}</span><br>`;
                
                messageMeta = `
                    <div class="message-meta">
                        Model: ${routingResult.model_used} | 
                        Latency: ${routingResult.latency.toFixed(2)}s | 
                        Confidence: ${Math.round(routingResult.confidence * 100)}%
                        ${routingResult.cached ? ' | <i class="fas fa-save"></i> Cached' : ''}
                    </div>
                `;
            }
            
            messageDiv.innerHTML = `
                ${routingBadge}
                ${content}
                ${messageMeta}
                ${type === 'assistant' ? `
                    <div class="feedback-actions">
                        <button class="btn btn-sm btn-outline-success" onclick="provideFeedback('positive')">
                            <i class="fas fa-thumbs-up"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-danger" onclick="provideFeedback('negative')">
                            <i class="fas fa-thumbs-down"></i>
                        </button>
                    </div>
                ` : ''}
            `;
            
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }
        
        function showTypingIndicator() {
            document.getElementById('typing-indicator').style.display = 'block';
        }
        
        function hideTypingIndicator() {
            document.getElementById('typing-indicator').style.display = 'none';
        }
        
        function analyzeQuery(query) {
            // Simple client-side analysis for UI feedback
            const complexityKeywords = {
                trivial: ['hi', 'hello', 'thanks', 'yes', 'no'],
                simple: ['what', 'when', 'where', 'who'],
                moderate: ['how', 'why', 'explain'],
                complex: ['analyze', 'compare', 'create'],
                expert: ['optimize', 'implement', 'architecture']
            };
            
            let complexity = 'simple';
            let complexityScore = 0.2;
            
            const queryLower = query.toLowerCase();
            
            for (const [level, keywords] of Object.entries(complexityKeywords)) {
                const matches = keywords.filter(keyword => queryLower.includes(keyword)).length;
                if (matches > 0) {
                    complexity = level;
                    complexityScore = {
                        trivial: 0.1,
                        simple: 0.3,
                        moderate: 0.5,
                        complex: 0.7,
                        expert: 0.9
                    }[level];
                    break;
                }
            }
            
            // Update complexity indicator
            const complexityFill = document.getElementById('complexity-fill');
            complexityFill.className = `complexity-fill complexity-${complexity}`;
            complexityFill.style.width = `${complexityScore * 100}%`;
            
            // Update privacy indicator
            const privacyKeywords = ['personal', 'private', 'my', 'i', 'me'];
            const privacyScore = Math.min(1.0, 
                privacyKeywords.filter(keyword => queryLower.includes(keyword)).length / 3);
            
            const privacyFill = document.getElementById('privacy-fill');
            privacyFill.style.width = `${privacyScore * 100}%`;
            document.getElementById('privacy-score').textContent = privacyScore.toFixed(1);
        }
        
        function clearChat() {
            document.getElementById('chat-container').innerHTML = `
                <div class="message system">
                    <i class="fas fa-robot me-2"></i>
                    Personal AI Assistant ready. I can help you with questions, tasks, and remember your preferences.
                </div>
            `;
            chatHistory = [];
        }
        
        function addMemory() {
            const modal = new bootstrap.Modal(document.getElementById('memoryModal'));
            modal.show();
        }
        
        function setPreference() {
            const modal = new bootstrap.Modal(document.getElementById('preferenceModal'));
            modal.show();
        }
        
        async function saveMemory() {
            const category = document.getElementById('memory-category').value;
            const key = document.getElementById('memory-key').value;
            const value = document.getElementById('memory-value').value;
            const context = document.getElementById('memory-context').value;
            
            if (!category || !key || !value) {
                alert('Please fill in all required fields');
                return;
            }
            
            try {
                const response = await fetch('/api/personal-ai/memory', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        category: category,
                        key: key,
                        value: value,
                        context: context
                    })
                });
                
                if (response.ok) {
                    bootstrap.Modal.getInstance(document.getElementById('memoryModal')).hide();
                    loadPersonalMemory();
                    
                    // Clear form
                    document.getElementById('memory-category').value = '';
                    document.getElementById('memory-key').value = '';
                    document.getElementById('memory-value').value = '';
                    document.getElementById('memory-context').value = '';
                } else {
                    alert('Failed to save memory');
                }
                
            } catch (error) {
                alert('Error saving memory: ' + error.message);
            }
        }
        
        async function savePreference() {
            const category = document.getElementById('preference-category').value;
            const key = document.getElementById('preference-key').value;
            const value = document.getElementById('preference-value').value;
            const strength = document.getElementById('preference-strength').value;
            
            if (!key || !value) {
                alert('Please fill in all required fields');
                return;
            }
            
            try {
                const response = await fetch('/api/personal-ai/preference', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        category: category,
                        preference: key,
                        value: value,
                        strength: parseFloat(strength)
                    })
                });
                
                if (response.ok) {
                    bootstrap.Modal.getInstance(document.getElementById('preferenceModal')).hide();
                    loadPersonalMemory();
                    
                    // Clear form
                    document.getElementById('preference-key').value = '';
                    document.getElementById('preference-value').value = '';
                    document.getElementById('preference-strength').value = '0.8';
                } else {
                    alert('Failed to save preference');
                }
                
            } catch (error) {
                alert('Error saving preference: ' + error.message);
            }
        }
        
        async function testOllama() {
            try {
                const response = await fetch('/api/personal-ai/test-ollama', {
                    method: 'POST'
                });
                
                const data = await response.json();
                
                if (data.success) {
                    alert('Ollama test successful!');
                    checkOllamaStatus();
                } else {
                    alert('Ollama test failed: ' + data.error);
                }
                
            } catch (error) {
                alert('Error testing Ollama: ' + error.message);
            }
        }
        
        async function provideFeedback(type) {
            // Simple feedback for now
            console.log(`Feedback: ${type}`);
            // Could implement more sophisticated feedback collection
        }
        
        function viewPersonalContext() {
            loadPersonalMemory();
            alert('Personal context refreshed!');
        }
    </script>
</body>
</html>